name: Ping Streamlit App

on:
  schedule:
    - cron: '0 */6 * * *'   # Executa a cada 6 horas
  workflow_dispatch:         # Permite rodar manualmente pelo bot√£o "Run workflow"

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Debug DNS
        run: |
          echo "üîé Testando resolu√ß√£o de DNS..."
          nslookup seu-app.streamlit.app || true
          ping -c 3 seu-app.streamlit.app || true

      - name: Testar acesso ao app
        run: |
          echo "Acessando o app em $(date)"
          STATUS=$(curl -s -L --max-redirs 100 --max-time 60 -o /dev/null -w "%{http_code}" https://marketplacesolidario.streamlit.app)
          echo "Status HTTP: $STATUS"
          if [ "$STATUS" -ne 200 ]; then
            echo "‚ö†Ô∏è O app n√£o respondeu corretamente! (Status $STATUS)"
            exit 1
          else
            echo "‚úÖ O app est√° online."
          fi
