name: Ping Streamlit App

on:
  schedule:
    - cron: '0 */6 * * *'   # Executa a cada 6 horas
  workflow_dispatch:         # Permite rodar manualmente

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Testar acesso ao app
        run: |
          echo "Acessando o app em $(date)"
          STATUS=$(curl -s -L --max-redirs 10 --max-time 60 -o /dev/null -w "%{http_code}" https://marketplacesolidario.streamlit.app)
          echo "Status HTTP: $STATUS"
          if [ "$STATUS" -eq 200 ]; then
            echo "✅ O app está online."
          else
            echo "⚠️ O app não respondeu corretamente! (Status $STATUS)"
            # não dá exit 1, só avisa
          fi
